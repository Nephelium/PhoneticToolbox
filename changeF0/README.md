# changeF0 - 基频与语速修改工具

## 项目简介
`changeF0` 是一个基于 Python 和 Parselmouth (Praat) 的音频处理工具，专注于基频 (F0) 的精细修改与语速调整。它提供了直观的图形用户界面 (GUI)，支持单个音频的可视化编辑以及多文件的批量自动化处理。该工具特别适合语音学研究、语音合成实验以及需要精确控制音高和时长的场景。

## 主要功能

### 1. 可视化基频编辑 (Pitch Editor)
- **波形与基频显示**：实时显示原始波形、合成波形以及基频曲线。
- **交互式编辑**：
  - **绘制曲线**：按住 `Shift` 键并拖动鼠标左键，可自由绘制基频曲线。
  - **擦除/重置**：按住 `Ctrl` 键并拖动鼠标，可将选定区域的基频恢复为默认值。
  - **添加/移动拐点**：支持点击添加关键点（拐点），并拖动调整频率和时间位置。
- **历史对比**：提供“历史F0对比”视图，可直观比较修改前后的基频差异。

### 2. 批量处理工具 (Batch Processor)
- **多维度调整**：支持对整个文件夹的音频进行统一处理。
  - **语速 (Speed)**：调整音频时长（如 0.8x 慢速, 1.2x 快速）。
  - **音高倍率 (Pitch Ratio)**：按比例整体升降调（如 1.1 倍频）。
  - **音高偏移 (Pitch Shift)**：按赫兹 (Hz) 数值平移基频（如 +20Hz）。
- **线性/动态基频生成**：支持通过设置起始/终止时间和频率列表，批量生成线性变化的基频曲线。

### 3. 合成与导出
- **实时合成**：修改参数后可即时合成音频并试听。
- **智能保存**：支持保存修改后的音频，并自动进行文件编号。
- **对比图导出**：一键保存包含波形、基频曲线对比的分析图表。

### 4. 辅助工具
- **参考线**：支持添加自定义频率参考线（如 200Hz），辅助精确调整。
- **Y轴范围控制**：可手动设置基频显示的频率范围（如 50-350Hz）。

## 安装与依赖

确保已安装 Python 3.8+，并安装以下依赖库：

```bash
pip install numpy scipy matplotlib parselmouth-praat sounddevice soundfile PyQt6 pyqtgraph
```

*(注意：请根据实际环境可能需要安装 `PyQt6-tools` 或其他音频后端驱动)*

## 使用指南

### 启动程序
运行主脚本启动界面：
```bash
python changeF0.py
```

### 单文件编辑流程
1. 点击 **"📂 加载音频"** 选择 wav/mp3/flac 文件。
2. 在 **"基频编辑"** 区域，按住 `Shift` 绘制新的基频曲线，或使用右侧面板添加拐点。
3. 点击 **"🎹 合成当前视野"** 生成修改后的音频。
4. 点击 **"▶️ 播放合成音"** 试听效果。
5. 满意后点击 **"💾 保存并编号"** 导出文件。

### 批量处理流程
1. 点击顶部 **"🛠️ 批量变速变调工具"** 按钮。
2. 在弹出的对话框中选择包含音频的文件夹。
3. 设置语速倍率、音高倍率或偏移量。
4. 点击 **"开始处理"**，程序将自动在原文件夹下创建 `processed_...` 目录保存结果。

## 快捷键说明
- **Shift + 左键拖动**：绘制/修改基频曲线。
- **Ctrl + 左键拖动**：擦除/还原基频曲线至默认状态。
- **鼠标滚轮**：缩放视图。
