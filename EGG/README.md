# EGG - 电声门图信号分析工具

## 项目简介
`EGG` (Electroglottography) 分析工具是一个用于处理和分析电声门图信号的专业软件。它支持双声道信号的加载、预处理、特征提取以及可视化。该工具专为语音生理学研究设计，能够精确检测声门闭合时刻 (GCIs) 和声门开启时刻 (GOIs)，并支持批量处理大量音频数据。

## 主要功能

### 1. 信号预处理与归一化
- **双声道归一化**：自动将左右声道的幅度分别归一化至 **-0.7 ~ 0.7** 范围，确保信号强度的一致性。
- **滤波处理**：
  - **高通滤波**：去除低频漂移（截止频率可调，上限已优化至 50Hz）。
  - **低通滤波**：去除高频噪声。
- **反相功能**：支持左右声道独立反相，以适应不同采集设备的极性差异。

### 2. 声门运动检测
- **声门垂直移动检测**：
  - 新增 **"声门移动"** 检测功能，通过分析低频能量极强点，自动识别喉头的垂直运动（升/降）。
  - **可视化标记**：在语谱图上以 **黄色垂直线** 标记检测到的声门剧烈运动时刻，辅助判断发音稳定性。

### 3. 可视化交互界面
- **多视图显示**：
  - 原始波形图 (EGG / Audio)
  - 微分波形 (dEGG)
  - 宽带/窄带语谱图
- **ROI (感兴趣区域) 选择**：支持鼠标拖拽选择分析区域，放大查看局部细节。
- **全中文界面**：界面已全面本地化为中文，操作更加直观。

### 4. 批量处理 (Batch Processing)
- **自动化分析**：支持对指定文件夹下的所有音频文件进行批量处理。
- **智能静音判别**：在归一化之后应用静音阈值，有效剔除无效片段。
- **数据导出**：自动计算并导出 Open Quotient (OQ), Speed Quotient (SQ), F0 等关键生理参数至 CSV/Excel 文件。

## 安装与依赖

本工具依赖以下 Python 库：

```bash
pip install numpy scipy matplotlib PyQt6 pyqtgraph pandas
```

## 使用指南

### 启动程序
```bash
python main_app.py
```

### 单文件分析
1. 点击 **"打开文件"** 加载 EGG 音频数据（支持 wav 等格式）。
2. 在主界面调整 **高通/低通滤波器** 滑块以获得清晰波形。
3. 点击 **"归一化"** 按钮确保信号幅度标准。
4. 点击 **"声门移动"** 按钮开启喉头垂直运动检测，观察语谱图上的黄色标记。
5. 使用鼠标在波形图上框选 ROI，查看详细的 dEGG 和声门接触参数。

### 批量处理
1. 点击菜单栏或工具栏中的 **"批量处理"**。
2. 设置输入文件夹和输出路径。
3. 配置静音阈值和其他分析参数。
4. 点击开始，等待处理完成。

## 注意事项
- 归一化操作会改变信号的绝对幅度，但保留相对形态，适用于大多数接触率分析。
- 声门移动检测依赖于低频高能特征，对于极其微弱的信号可能需要调整检测灵敏度（目前为内部固定阈值）。

## 许可证
MIT License
